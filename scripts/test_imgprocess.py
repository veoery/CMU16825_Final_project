from transformers import Dinov2Model, AutoImageProcessor
from PIL import Image

model_name = "facebook/dinov2-large"
processor = AutoImageProcessor.from_pretrained(model_name)

img_path = "data/Omni-CAD/img/cube.jpeg"
img = Image.open(img_path).convert("RGB")

processed = processor(img, return_tensors="pt")

print(processed)
# {'pixel_values': [array([[[2.2489083, 2.2489083, 2.2489083, ..., 2.2489083, 2.2489083,
#          2.2489083],
#         [2.2489083, 2.2489083, 2.2489083, ..., 2.2489083, 2.2489083,
#          2.2489083],
#         [2.2489083, 2.2489083, 2.2489083, ..., 2.2489083, 2.2489083,
#          2.2489083],
#         ...,
#         [2.2489083, 2.2489083, 2.2489083, ..., 2.2489083, 2.2489083,
#          2.2489083],
#         [2.2489083, 2.2489083, 2.2489083, ..., 2.2489083, 2.2489083,
#          2.2489083],
#         [2.2489083, 2.2489083, 2.2489083, ..., 2.2489083, 2.2489083,
#          2.2489083]],

#        [[2.4285715, 2.4285715, 2.4285715, ..., 2.4285715, 2.4285715,
#          2.4285715],
#         [2.4285715, 2.4285715, 2.4285715, ..., 2.4285715, 2.4285715,
#          2.4285715],
#         [2.4285715, 2.4285715, 2.4285715, ..., 2.4285715, 2.4285715,
#          2.4285715],
#         ...,
#         [2.4285715, 2.4285715, 2.4285715, ..., 2.4285715, 2.4285715,
#          2.4285715],
#         [2.4285715, 2.4285715, 2.4285715, ..., 2.4285715, 2.4285715,
#          2.4285715],
#         [2.4285715, 2.4285715, 2.4285715, ..., 2.4285715, 2.4285715,
#          2.4285715]],

#        [[2.64     , 2.64     , 2.64     , ..., 2.64     , 2.64     ,
#          2.64     ],
#         [2.64     , 2.64     , 2.64     , ..., 2.64     , 2.64     ,
#          2.64     ],
#         [2.64     , 2.64     , 2.64     , ..., 2.64     , 2.64     ,
#          2.64     ],
#         ...,
#         [2.64     , 2.64     , 2.64     , ..., 2.64     , 2.64     ,
#          2.64     ],
#         [2.64     , 2.64     , 2.64     , ..., 2.64     , 2.64     ,
#          2.64     ],
#         [2.64     , 2.64     , 2.64     , ..., 2.64     , 2.64     ,
#          2.64     ]]], shape=(3, 224, 224), dtype=float32)]}
print(processed["pixel_values"].shape)